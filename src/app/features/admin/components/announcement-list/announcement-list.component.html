<!-- ===================================================================
src/app/features/admin/components/announcement-list/announcement-list.component.html
==================================================================== -->
<app-header />
<app-sidebar>
  <div class="announcement-list-container">
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <h2>إدارة الإعلانات</h2>
        </mat-card-title>
        <div class="header-actions">
          <button
            mat-raised-button
            color="primary"
            (click)="createAnnouncement()"
          >
            <mat-icon>add</mat-icon>
            إضافة إعلان جديد
          </button>
        </div>
      </mat-card-header>

      <mat-card-content>
        @if (loading()) {
        <div class="loading-container">
          <mat-spinner diameter="50"></mat-spinner>
          <p>جارٍ تحميل الإعلانات...</p>
        </div>
        } @else if (announcements().length === 0) {
        <div class="empty-state">
          <mat-icon>campaign</mat-icon>
          <h3>لا توجد إعلانات</h3>
          <p>ابدأ بإضافة إعلان جديد</p>
          <button
            mat-raised-button
            color="primary"
            (click)="createAnnouncement()"
          >
            إضافة إعلان
          </button>
        </div>
        } @else {
        <div class="table-container">
          <table
            mat-table
            [dataSource]="announcements()"
            class="announcements-table"
          >
            <!-- Type Column -->
            <ng-container matColumnDef="type">
              <th mat-header-cell *matHeaderCellDef>النوع</th>
              <td mat-cell *matCellDef="let announcement">
                <mat-chip
                  [style.background-color]="getTypeColor(announcement.type)"
                >
                  {{ getTypeLabel(announcement.type) }}
                </mat-chip>
              </td>
            </ng-container>

            <!-- Title Column -->
            <ng-container matColumnDef="title">
              <th mat-header-cell *matHeaderCellDef>العنوان</th>
              <td mat-cell *matCellDef="let announcement">
                <div class="title-cell">
                  <strong>{{ announcement.title }}</strong>
                  <small class="message-preview"
                    >{{ announcement.message | slice : 0 : 50 }}...</small
                  >
                </div>
              </td>
            </ng-container>

            <!-- Priority Column -->
            <ng-container matColumnDef="priority">
              <th mat-header-cell *matHeaderCellDef>الأولوية</th>
              <td mat-cell *matCellDef="let announcement">
                <mat-chip
                  [style.background-color]="
                    getPriorityColor(announcement.priority)
                  "
                >
                  {{ getPriorityLabel(announcement.priority) }}
                </mat-chip>
              </td>
            </ng-container>

            <!-- Dates Column -->
            <ng-container matColumnDef="dates">
              <th mat-header-cell *matHeaderCellDef>التواريخ</th>
              <td mat-cell *matCellDef="let announcement">
                <div class="dates-cell">
                  <small>من: {{ announcement.startDate }}</small>
                  @if (announcement.endDate) {
                  <small>إلى: {{ announcement.endDate }}</small>
                  } @else {
                  <small>بدون نهاية</small>
                  }
                </div>
              </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>الحالة</th>
              <td mat-cell *matCellDef="let announcement">
                <mat-chip
                  [class.active]="announcement.isActive"
                  [class.inactive]="!announcement.isActive"
                >
                  {{ announcement.isActive ? "نشط" : "غير نشط" }}
                </mat-chip>
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>الإجراءات</th>
              <td mat-cell *matCellDef="let announcement">
                <button mat-icon-button [matMenuTriggerFor]="menu">
                  <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                  <button
                    mat-menu-item
                    (click)="editAnnouncement(announcement)"
                  >
                    <mat-icon>edit</mat-icon>
                    <span>تعديل</span>
                  </button>
                  <button mat-menu-item (click)="toggleStatus(announcement)">
                    <mat-icon>{{
                      announcement.isActive ? "visibility_off" : "visibility"
                    }}</mat-icon>
                    <span>{{
                      announcement.isActive ? "إلغاء التفعيل" : "تفعيل"
                    }}</span>
                  </button>
                  <button
                    mat-menu-item
                    (click)="deleteAnnouncement(announcement)"
                    class="delete-action"
                  >
                    <mat-icon>delete</mat-icon>
                    <span>حذف</span>
                  </button>
                </mat-menu>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>

          <mat-paginator
            [length]="totalElements()"
            [pageSize]="pageSize()"
            [pageIndex]="pageIndex()"
            [pageSizeOptions]="[5, 10, 25, 50]"
            (page)="onPageChange($event)"
            showFirstLastButtons
          >
          </mat-paginator>
        </div>
        }
      </mat-card-content>
    </mat-card>
  </div>
</app-sidebar>
